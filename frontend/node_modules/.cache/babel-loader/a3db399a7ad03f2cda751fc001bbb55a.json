{"ast":null,"code":"import _defineProperty from\"C:/Users/admin/PycharmProjects/dz_trvp/trvp_dz/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/admin/PycharmProjects/dz_trvp/trvp_dz/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/admin/PycharmProjects/dz_trvp/trvp_dz/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/admin/PycharmProjects/dz_trvp/trvp_dz/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";var _extraReducers;import{createSlice,createAsyncThunk}from\"@reduxjs/toolkit\";import axios from\"../../axios\";export var fetchMenu=createAsyncThunk('menus/fetchMenu',/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/menu');case 2:_yield$axios$get=_context.sent;data=_yield$axios$get.data;return _context.abrupt(\"return\",data);case 5:case\"end\":return _context.stop();}}},_callee);})));export var fetchRemoveMenu=createAsyncThunk('menus/fetchRemoveMenu',/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(id){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.abrupt(\"return\",axios.delete(\"/menu/\".concat(id)));case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}());export var fetchUpdateMenu=createAsyncThunk('menus/fetchUpdateMenu',/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(_ref3){var menuId,id,flag,response;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:menuId=_ref3.menuId,id=_ref3.id,flag=_ref3.flag;_context3.next=3;return axios.patch(\"/menu/\".concat(menuId),flag);case 3:response=_context3.sent;return _context3.abrupt(\"return\",{menuId:menuId});case 5:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x2){return _ref4.apply(this,arguments);};}());export var transferDishes=createAsyncThunk('menus/transferDishes',/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(_ref5){var sourceMenuId,targetMenuId,dishIds,response;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:sourceMenuId=_ref5.sourceMenuId,targetMenuId=_ref5.targetMenuId,dishIds=_ref5.dishIds;_context4.next=3;return axios.post('/transfer-dishes',{sourceMenuId:sourceMenuId,targetMenuId:targetMenuId,dishIds:dishIds});case 3:response=_context4.sent;return _context4.abrupt(\"return\",response.data);case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x3){return _ref6.apply(this,arguments);};}());var initialState={menus:{items:[],status:'loading'}};var menusSlice=createSlice({name:'menus',initialState:initialState,reducer:{},extraReducers:(_extraReducers={},_defineProperty(_extraReducers,fetchMenu.pending,function(state){state.menus.status='loading';}),_defineProperty(_extraReducers,fetchMenu.fulfilled,function(state,action){state.menus.items=action.payload;state.menus.status='loaded';}),_defineProperty(_extraReducers,fetchMenu.rejected,function(state){state.menus.items=[];state.menus.status='error';}),_defineProperty(_extraReducers,fetchRemoveMenu.pending,function(state,action){state.menus.items=state.menus.items.filter(function(obj){return obj._id!==action.meta.arg;});}),_defineProperty(_extraReducers,fetchUpdateMenu.pending,function(state){state.menus.status='loading';}),_defineProperty(_extraReducers,fetchUpdateMenu.fulfilled,function(state,action){var updatedMenuId=action.meta.arg.menuId;var updatedDishId=action.meta.arg.id;var index=state.menus.items.findIndex(function(menu){return menu._id===updatedMenuId;});if(index!==-1){// Используем map для обновления массива dishes\nstate.menus.items[index]=_objectSpread(_objectSpread({},state.menus.items[index]),{},{dishes:state.menus.items[index].dishes.filter(function(dish){return dish._id!==updatedDishId;})});}state.menus.status='loaded';}),_defineProperty(_extraReducers,transferDishes.pending,function(state){state.menus.status='loading';}),_defineProperty(_extraReducers,transferDishes.fulfilled,function(state,action){// Handle the successful transfer if needed\nstate.menus.status='loaded';}),_defineProperty(_extraReducers,transferDishes.rejected,function(state){// Handle the error if needed\nstate.menus.status='error';}),_extraReducers)});export var menuReducer=menusSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","fetchMenu","get","data","fetchRemoveMenu","id","delete","fetchUpdateMenu","menuId","flag","patch","response","transferDishes","sourceMenuId","targetMenuId","dishIds","post","initialState","menus","items","status","menusSlice","name","reducer","extraReducers","pending","state","fulfilled","action","payload","rejected","filter","obj","_id","meta","arg","updatedMenuId","updatedDishId","index","findIndex","menu","dishes","dish","menuReducer"],"sources":["C:/Users/admin/PycharmProjects/dz_trvp/trvp_dz/frontend/src/redux/slices/menus.js"],"sourcesContent":["import {createSlice, createAsyncThunk} from \"@reduxjs/toolkit\";\r\nimport axios from \"../../axios\";\r\n\r\nexport const fetchMenu = createAsyncThunk('menus/fetchMenu', async () => {\r\n    const {data} = await axios.get('/menu');\r\n    return data;\r\n});\r\n\r\nexport const fetchRemoveMenu = createAsyncThunk('menus/fetchRemoveMenu', async (id) =>\r\n    axios.delete(`/menu/${id}`)\r\n);\r\n\r\nexport const fetchUpdateMenu = createAsyncThunk('menus/fetchUpdateMenu', async ({ menuId, id, flag }) => {\r\n    const response = await axios.patch(`/menu/${menuId}`, flag);\r\n    return { menuId };\r\n});\r\n\r\nexport const transferDishes = createAsyncThunk('menus/transferDishes', async ({ sourceMenuId, targetMenuId, dishIds }) => {\r\n    const response = await axios.post('/transfer-dishes', { sourceMenuId, targetMenuId, dishIds });\r\n    return response.data;\r\n});\r\n\r\nconst initialState = {\r\n    menus: {\r\n        items: [],\r\n        status: 'loading'\r\n    }\r\n};\r\n\r\nconst menusSlice = createSlice({\r\n    name: 'menus',\r\n    initialState,\r\n    reducer: {},\r\n    extraReducers: {\r\n        // Получение меню\r\n        [fetchMenu.pending]: (state) => {\r\n            state.menus.status = 'loading';\r\n        },\r\n        [fetchMenu.fulfilled]: (state, action) => {\r\n            state.menus.items = action.payload;\r\n            state.menus.status = 'loaded';\r\n        },\r\n        [fetchMenu.rejected]: (state) => {\r\n            state.menus.items = [];\r\n            state.menus.status = 'error';\r\n        },\r\n\r\n        // Удаление меню\r\n        [fetchRemoveMenu.pending]: (state, action) => {\r\n            state.menus.items = state.menus.items.filter(obj => obj._id !== action.meta.arg);\r\n        },\r\n\r\n\r\n\r\n\r\n\r\n        //Обновление меню\r\n        [fetchUpdateMenu.pending]: (state) => {\r\n            state.menus.status = 'loading';\r\n        },\r\n        [fetchUpdateMenu.fulfilled]: (state, action) => {\r\n            const updatedMenuId = action.meta.arg.menuId;\r\n            const updatedDishId = action.meta.arg.id;\r\n\r\n            const index = state.menus.items.findIndex(menu => menu._id === updatedMenuId);\r\n\r\n            if (index !== -1) {\r\n                // Используем map для обновления массива dishes\r\n                state.menus.items[index] = {\r\n                    ...state.menus.items[index],\r\n                    dishes: state.menus.items[index].dishes.filter(dish => dish._id !== updatedDishId),\r\n                };\r\n            }\r\n\r\n            state.menus.status = 'loaded';\r\n        },\r\n\r\n\r\n        [transferDishes.pending]: (state) => {\r\n            state.menus.status = 'loading';\r\n        },\r\n        [transferDishes.fulfilled]: (state, action) => {\r\n            // Handle the successful transfer if needed\r\n            state.menus.status = 'loaded';\r\n        },\r\n        [transferDishes.rejected]: (state) => {\r\n            // Handle the error if needed\r\n            state.menus.status = 'error';\r\n        },\r\n\r\n\r\n    },\r\n});\r\n\r\nexport const menuReducer = menusSlice.reducer;"],"mappings":"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"},"metadata":{},"sourceType":"module"}