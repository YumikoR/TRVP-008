{"ast":null,"code":"import _objectSpread from\"C:/Users/admin/PycharmProjects/dz_trvp/trvp_dz/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/admin/PycharmProjects/dz_trvp/trvp_dz/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/admin/PycharmProjects/dz_trvp/trvp_dz/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{Navigate}from\"react-router-dom\";import Typography from\"@mui/material/Typography\";import TextField from\"@mui/material/TextField\";import Paper from\"@mui/material/Paper\";import Button from\"@mui/material/Button\";import{useForm}from'react-hook-form';import styles from\"./Login.module.scss\";import{fetchAuth,selectIsAuth}from\"../../redux/slices/auth\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var Login=function Login(){var _errors$email,_errors$email2,_errors$password,_errors$password2;var isAuth=useSelector(selectIsAuth);var dispatch=useDispatch();var _useForm=useForm({defaultValues:{// УБРАТЬ!!!!!!\n},mode:'onChange'}),register=_useForm.register,handleSubmit=_useForm.handleSubmit,setError=_useForm.setError,_useForm$formState=_useForm.formState,errors=_useForm$formState.errors,isValid=_useForm$formState.isValid;var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(values){var data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return dispatch(fetchAuth(values));case 2:data=_context.sent;if(data.payload){_context.next=7;break;}return _context.abrupt(\"return\",alert('Не удалось авторизоваться'));case 7:if('token'in data.payload){window.localStorage.setItem('token',data.payload.token);}case 8:case\"end\":return _context.stop();}}},_callee);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();if(isAuth){return/*#__PURE__*/_jsx(Navigate,{to:\"/\"});}return/*#__PURE__*/_jsxs(Paper,{classes:{root:styles.root},children:[/*#__PURE__*/_jsx(Typography,{classes:{root:styles.title},variant:\"h5\",children:\"\\u0412\\u0445\\u043E\\u0434 \\u0432 \\u0430\\u043A\\u043A\\u0430\\u0443\\u043D\\u0442\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({className:styles.field,label:\"E-Mail\",type:\"email\",error:Boolean((_errors$email=errors.email)===null||_errors$email===void 0?void 0:_errors$email.message),helperText:(_errors$email2=errors.email)===null||_errors$email2===void 0?void 0:_errors$email2.message},register('email',{required:'Укажите почту'})),{},{fullWidth:true})),/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({className:styles.field,label:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\",type:\"password\",error:Boolean((_errors$password=errors.password)===null||_errors$password===void 0?void 0:_errors$password.message),helperText:(_errors$password2=errors.password)===null||_errors$password2===void 0?void 0:_errors$password2.message},register('password',{required:'Укажите пароль'})),{},{fullWidth:true})),/*#__PURE__*/_jsx(Button,{disabled:!isValid,type:\"submit\",size:\"large\",variant:\"contained\",fullWidth:true,children:\"\\u0412\\u043E\\u0439\\u0442\\u0438\"})]})]});};","map":{"version":3,"names":["React","useDispatch","useSelector","Navigate","Typography","TextField","Paper","Button","useForm","styles","fetchAuth","selectIsAuth","Login","isAuth","dispatch","defaultValues","mode","register","handleSubmit","setError","formState","errors","isValid","onSubmit","values","data","payload","alert","window","localStorage","setItem","token","root","title","field","Boolean","email","message","required","password"],"sources":["C:/Users/admin/PycharmProjects/dz_trvp/trvp_dz/frontend/src/pages/Login/index.jsx"],"sourcesContent":["import React from \"react\";\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {Navigate} from \"react-router-dom\";\r\nimport Typography from \"@mui/material/Typography\";\r\nimport TextField from \"@mui/material/TextField\";\r\nimport Paper from \"@mui/material/Paper\";\r\nimport Button from \"@mui/material/Button\";\r\nimport {useForm} from 'react-hook-form';\r\n\r\nimport styles from \"./Login.module.scss\";\r\nimport {fetchAuth, selectIsAuth} from \"../../redux/slices/auth\";\r\n\r\n\r\nexport const Login = () => {\r\n    const isAuth = useSelector(selectIsAuth);\r\n    const dispatch = useDispatch();\r\n\r\n    const {\r\n        register,\r\n        handleSubmit,\r\n        setError,\r\n        formState: {errors, isValid}\r\n    } = useForm({\r\n        defaultValues: {// УБРАТЬ!!!!!!\r\n\r\n        },\r\n        mode: 'onChange'\r\n\r\n    })\r\n\r\n    const onSubmit = async (values) => {\r\n        const data = await dispatch(fetchAuth(values));\r\n        if (!data.payload) {\r\n            return alert('Не удалось авторизоваться')\r\n        } else {\r\n            if('token' in data.payload){\r\n                window.localStorage.setItem('token', data.payload.token);\r\n            }\r\n        }\r\n    }\r\n\r\n    if(isAuth) {\r\n        return <Navigate to=\"/\"/>\r\n    }\r\n\r\n\r\n\r\n    return (\r\n        <Paper classes={{root: styles.root}}>\r\n            <Typography classes={{root: styles.title}} variant=\"h5\">\r\n                Вход в аккаунт\r\n            </Typography>\r\n            <form onSubmit={handleSubmit(onSubmit)}>\r\n                <TextField\r\n                    className={styles.field}\r\n                    label=\"E-Mail\"\r\n                    type=\"email\"\r\n                    error={Boolean(errors.email?.message)}\r\n                    helperText={errors.email?.message}\r\n                    {...register('email', {required: 'Укажите почту'})}\r\n                    fullWidth\r\n                />\r\n                <TextField\r\n                    className={styles.field}\r\n                    label=\"Пароль\"\r\n                    type=\"password\"\r\n                    error={Boolean(errors.password?.message)}\r\n                    helperText={errors.password?.message}\r\n                    {...register('password', {required: 'Укажите пароль'})}\r\n                    fullWidth\r\n                />\r\n                <Button disabled={!isValid} type=\"submit\" size=\"large\" variant=\"contained\" fullWidth>\r\n                    Войти\r\n                </Button>\r\n            </form>\r\n        </Paper>\r\n    );\r\n};\r\n"],"mappings":"sbAAA,MAAOA,MAAP,KAAkB,OAAlB,CACA,OAAQC,WAAR,CAAqBC,WAArB,KAAuC,aAAvC,CACA,OAAQC,QAAR,KAAuB,kBAAvB,CACA,MAAOC,WAAP,KAAuB,0BAAvB,CACA,MAAOC,UAAP,KAAsB,yBAAtB,CACA,MAAOC,MAAP,KAAkB,qBAAlB,CACA,MAAOC,OAAP,KAAmB,sBAAnB,CACA,OAAQC,OAAR,KAAsB,iBAAtB,CAEA,MAAOC,OAAP,KAAmB,qBAAnB,CACA,OAAQC,SAAR,CAAmBC,YAAnB,KAAsC,yBAAtC,C,wFAGA,MAAO,IAAMC,MAAK,CAAG,QAARA,MAAQ,EAAM,qEACvB,GAAMC,OAAM,CAAGX,WAAW,CAACS,YAAD,CAA1B,CACA,GAAMG,SAAQ,CAAGb,WAAW,EAA5B,CAEA,aAKIO,OAAO,CAAC,CACRO,aAAa,CAAE,CAAC;AAAD,CADP,CAIRC,IAAI,CAAE,UAJE,CAAD,CALX,CACIC,QADJ,UACIA,QADJ,CAEIC,YAFJ,UAEIA,YAFJ,CAGIC,QAHJ,UAGIA,QAHJ,6BAIIC,SAJJ,CAIgBC,MAJhB,oBAIgBA,MAJhB,CAIwBC,OAJxB,oBAIwBA,OAJxB,CAaA,GAAMC,SAAQ,4FAAG,iBAAOC,MAAP,mJACMV,SAAQ,CAACJ,SAAS,CAACc,MAAD,CAAV,CADd,QACPC,IADO,kBAERA,IAAI,CAACC,OAFG,yDAGFC,KAAK,CAAC,2BAAD,CAHH,SAKT,GAAG,SAAWF,KAAI,CAACC,OAAnB,CAA2B,CACvBE,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,OAA5B,CAAqCL,IAAI,CAACC,OAAL,CAAaK,KAAlD,EACH,CAPQ,sDAAH,kBAARR,SAAQ,4CAAd,CAWA,GAAGV,MAAH,CAAW,CACP,mBAAO,KAAC,QAAD,EAAU,EAAE,CAAC,GAAb,EAAP,CACH,CAID,mBACI,MAAC,KAAD,EAAO,OAAO,CAAE,CAACmB,IAAI,CAAEvB,MAAM,CAACuB,IAAd,CAAhB,wBACI,KAAC,UAAD,EAAY,OAAO,CAAE,CAACA,IAAI,CAAEvB,MAAM,CAACwB,KAAd,CAArB,CAA2C,OAAO,CAAC,IAAnD,wFADJ,cAII,cAAM,QAAQ,CAAEf,YAAY,CAACK,QAAD,CAA5B,wBACI,KAAC,SAAD,8BACI,SAAS,CAAEd,MAAM,CAACyB,KADtB,CAEI,KAAK,CAAC,QAFV,CAGI,IAAI,CAAC,OAHT,CAII,KAAK,CAAEC,OAAO,gBAACd,MAAM,CAACe,KAAR,wCAAC,cAAcC,OAAf,CAJlB,CAKI,UAAU,iBAAEhB,MAAM,CAACe,KAAT,yCAAE,eAAcC,OAL9B,EAMQpB,QAAQ,CAAC,OAAD,CAAU,CAACqB,QAAQ,CAAE,eAAX,CAAV,CANhB,MAOI,SAAS,KAPb,GADJ,cAUI,KAAC,SAAD,8BACI,SAAS,CAAE7B,MAAM,CAACyB,KADtB,CAEI,KAAK,CAAC,sCAFV,CAGI,IAAI,CAAC,UAHT,CAII,KAAK,CAAEC,OAAO,mBAACd,MAAM,CAACkB,QAAR,2CAAC,iBAAiBF,OAAlB,CAJlB,CAKI,UAAU,oBAAEhB,MAAM,CAACkB,QAAT,4CAAE,kBAAiBF,OALjC,EAMQpB,QAAQ,CAAC,UAAD,CAAa,CAACqB,QAAQ,CAAE,gBAAX,CAAb,CANhB,MAOI,SAAS,KAPb,GAVJ,cAmBI,KAAC,MAAD,EAAQ,QAAQ,CAAE,CAAChB,OAAnB,CAA4B,IAAI,CAAC,QAAjC,CAA0C,IAAI,CAAC,OAA/C,CAAuD,OAAO,CAAC,WAA/D,CAA2E,SAAS,KAApF,4CAnBJ,GAJJ,GADJ,CA8BH,CAhEM"},"metadata":{},"sourceType":"module"}